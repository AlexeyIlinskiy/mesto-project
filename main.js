(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{k:()=>w});var t=document.querySelectorAll(".popup"),n=document.querySelector(".gallery__items"),o=document.querySelector("#item-template").content,r=document.querySelector("#popup-img"),c=document.querySelector(".img-popup__img"),a=document.querySelector(".img-popup__caption"),i=document.querySelector("#popup-edit-profile"),u=document.querySelector("#popup-add-item"),s=document.querySelector("#popup-update-avatar"),l=document.querySelector(".profile__edit-button"),d=document.querySelector(".profile__add-button"),m=document.querySelector(".profile__avatar-update-button"),f=document.querySelector("#form-edit-profile"),p=document.querySelector("#name-profile-input"),v=document.querySelector("#about-profile-input"),h=document.querySelector(".profile__name"),_=document.querySelector(".profile__about"),y=f.querySelector("#form-edit-profile-btn-submit"),b=document.querySelector("#form-update-avatar"),S=document.querySelector("#url-avatar-input"),q=document.querySelector(".profile__avatar"),k=b.querySelector("#form-update-avatar-btn-submit"),L=document.querySelector("#form-new-item"),C=document.querySelector("#url-item-input"),g=document.querySelector("#name-item-input"),E=L.querySelector(".form__button"),j={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"};function x(e){e.classList.add("popup_opened"),document.addEventListener("keydown",A)}function P(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",A)}function A(e){"Escape"===e.key&&P(document.querySelector(".popup_opened"))}function U(e,t,n,i,u){var s=o.cloneNode(!0),l=s.querySelector(".item__img"),d=s.querySelector(".item__title"),m=s.querySelector(".item__like-count");if(l.src=e,d.textContent=t,l.alt=t,l.id=n,m.textContent=i,s.querySelector(".item__btn-like").addEventListener("click",(function(e){e.target.classList.contains("item__btn-like_active")?(e.target.classList.remove("item__btn-like_active"),function(e,t){fetch("".concat(T.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:T.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){t.textContent=e.likes.length})).catch((function(e){console.log(e)}))}(n,m)):(e.target.classList.add("item__btn-like_active"),function(e,t){fetch("".concat(T.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:T.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){t.textContent=e.likes.length})).catch((function(e){console.log(e)}))}(n,m))})),"73418e87cd03bd75259347fb"===u){var f=s.querySelector(".item__btn-delete");f.style.display="block",f.addEventListener("click",(function(e){var t;e.target.closest(".item").remove(s),t=n,fetch("".concat(T.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:T.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)}))}))}return l.addEventListener("click",(function(){c.src=e,c.alt=t,a.textContent=t,x(r)})),s}function O(e,t){t.prepend(e)}t.forEach((function(e){e.addEventListener("click",(function(t){(t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__btn-close"))&&P(e)}))}));var T={baseUrl:"https://nomoreparties.co/v1/plus-cohort-11/",headers:{authorization:"f08a7d2d-99b7-4264-bc75-9c8d3d90332f","Content-Type":"application/json"}};function B(e,t){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,j):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,t.validationMessage,j)}function D(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.removeAttribute("disabled","")):(t.classList.add(n.inactiveButtonClass),t.setAttribute("disabled",""))}function w(e,t,n){t.textContent=e?"Сохранение...":n}l.addEventListener("click",(function(){p.value=h.textContent.trim(),v.value=_.textContent.trim(),x(i)})),f.addEventListener("submit",(function(e){e.preventDefault(),h.textContent=p.value,_.textContent=v.value,function(e,t){fetch("".concat(T.baseUrl,"/users/me"),{method:"PATCH",headers:T.headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(){w(!1,y,"Сохранить")})).catch((function(e){console.log(e)}))}(h.textContent,_.textContent),P(i)})),m.addEventListener("click",(function(){S.value=q.src.trim(),x(s)})),b.addEventListener("submit",(function(e){var t;e.preventDefault(),q.src=S.value,t=q.src,fetch("".concat(T.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:T.headers,body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(){w(!1,k,"Сохранить")})).catch((function(e){console.log(e)})),P(s)})),L.addEventListener("submit",(function(e){var t,o;e.preventDefault(),O(U(C.value,g.value),n),t=g.value,o=C.value,fetch("".concat(T.baseUrl,"/cards"),{method:"POST",headers:T.headers,body:JSON.stringify({name:t,link:o})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(){w(!1,E,"Создать")})).catch((function(e){console.log(e)})),E.classList.add(j.inactiveButtonClass),E.setAttribute("disabled",""),L.reset(),P(u)})),d.addEventListener("click",(function(){x(u)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);D(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){B(e,r),D(n,o,t)}))}))}(t,e)}))}(j),fetch("".concat(T.baseUrl,"/cards"),{headers:T.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.forEach((function(e){O(U(e.link,e.name,e._id,e.likes.length,e.owner._id),n)}))})).catch((function(e){console.log(e)})),fetch("".concat(T.baseUrl,"/users/me"),{headers:T.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){h.textContent=e.name,_.textContent=e.about,q.src=e.avatar})).catch((function(e){console.log(e)}))})();